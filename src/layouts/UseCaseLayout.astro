---
export interface Props {
	title: string;
	songTitle: string;
	genre: string;
	duration: string;
	clientType: 'Particulier' | 'Professionnel';
	objective: string;
	story: string;
	audioSrc: string;
	coverClosed: string;
	coverOpened: string;
	artist: string;
}

const { 
	title, 
	songTitle, 
	genre, 
	duration, 
	clientType, 
	objective, 
	story, 
	audioSrc, 
	coverClosed, 
	coverOpened,
	artist 
} = Astro.props;

import '../styles/global.css';
---

<html lang="fr">
<head>
	<meta charset="utf-8" />
	<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
	<meta name="viewport" content="width=device-width" />
	<title>{title} - Poppy Music Studio</title>
	<meta name="description" content={`Cas d'usage ${songTitle} - Studio de production musicale Poppy Music`} />
</head>

<body class="bg-[#0B0B0B] text-gray-100 font-['Inter'] antialiased">
	
	<!-- HEADER -->
	<header class="fixed top-0 left-0 right-0 z-50 glass-effect">
		<nav class="flex justify-between items-center px-8 py-6">
			<a href="/" class="title-artistic text-2xl text-[#E7C873] hover:opacity-80 transition-opacity">
				Poppy Music
			</a>
			<div class="text-artistic text-sm text-gray-400 uppercase tracking-wider">
				Studio de Production
			</div>
		</nav>
	</header>

	<!-- HERO CAS D'USAGE -->
	<section class="pt-32 pb-20 px-6 min-h-screen flex items-center">
		<div class="max-w-7xl mx-auto">
			<div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
				
				<!-- CONTENU -->
				<div>
					<div class="mb-6">
						<span class="inline-block px-4 py-2 bg-[#E7C873] bg-opacity-20 text-[#E7C873] text-sm font-medium rounded-full mb-4">
							{clientType}
						</span>
					</div>
					
					<h1 class="title-artistic text-5xl md:text-6xl text-white mb-6 leading-tight">
						{title}
					</h1>
					
					<div class="space-y-6 text-artistic text-lg text-gray-300 leading-relaxed">
						<div>
							<h3 class="text-[#E7C873] font-semibold mb-2">L'Objectif</h3>
							<p>{objective}</p>
						</div>
						
						<div>
							<h3 class="text-[#E7C873] font-semibold mb-2">L'Histoire</h3>
							<p>{story}</p>
						</div>
					</div>

					<div class="mt-12 flex flex-col sm:flex-row gap-4">
						<button class="bg-[#E7C873] text-black px-8 py-3 font-medium tracking-wide hover:bg-[#d4b556] transition-all duration-300">
							PRODUIRE MA CHANSON - 199€
						</button>
						<a href="/" class="border border-[#E7C873] text-[#E7C873] px-8 py-3 font-medium tracking-wide hover:bg-[#E7C873] hover:text-black transition-all duration-300 text-center">
							RETOUR AUX PRODUCTIONS
						</a>
					</div>
				</div>

				<!-- PLAYER INTÉGRÉ -->
				<div class="relative">
					<div class="album-container mx-auto mb-8" id="useCasePlayer">
						<div class="album-cover">
							<div class="album-cover-closed">
								<img src={coverClosed} alt="Album fermé" class="w-full h-full object-cover" />
							</div>
							<div class="album-cover-opened">
								<img src={coverOpened} alt="Album ouvert avec vinyle" class="w-full h-full object-cover" />
							</div>
						</div>
						<div class="album-play-button">
							<svg viewBox="0 0 24 24">
								<path d="M8 5v14l11-7z"/>
							</svg>
						</div>
						<div class="waveform">
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
							<div class="waveform-bar"></div>
						</div>
						<audio data-title={songTitle} data-artist={artist}>
							<source src={audioSrc} type={audioSrc.includes('.wav') ? 'audio/wav' : 'audio/mpeg'} />
						</audio>
					</div>
					
					<div class="text-center">
						<h3 class="text-white font-medium text-xl mb-2">{songTitle}</h3>
						<p class="text-gray-400">{genre} • {duration}</p>
						<p class="text-gray-500 text-sm mt-2">Produit par {artist}</p>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- PROCESSUS POUR CE CAS -->
	<section class="py-20 px-6 bg-gradient-to-b from-[#0B0B0B] to-[#121212]">
		<div class="max-w-4xl mx-auto text-center">
			<h2 class="title-artistic text-4xl text-white mb-12">
				Comment nous avons <span class="text-[#E7C873]">produit</span> cette chanson
			</h2>
			
			<div class="grid grid-cols-1 md:grid-cols-4 gap-8">
				<div class="text-center">
					<div class="w-16 h-16 bg-[#E7C873] bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4">
						<span class="text-[#E7C873] font-bold text-lg">1</span>
					</div>
					<h4 class="text-white font-semibold mb-2">Brief</h4>
					<p class="text-gray-400 text-sm">Compréhension du message et de l'émotion</p>
				</div>
				<div class="text-center">
					<div class="w-16 h-16 bg-[#E7C873] bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4">
						<span class="text-[#E7C873] font-bold text-lg">2</span>
					</div>
					<h4 class="text-white font-semibold mb-2">Création</h4>
					<p class="text-gray-400 text-sm">Composition des paroles et de la mélodie</p>
				</div>
				<div class="text-center">
					<div class="w-16 h-16 bg-[#E7C873] bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4">
						<span class="text-[#E7C873] font-bold text-lg">3</span>
					</div>
					<h4 class="text-white font-semibold mb-2">Production</h4>
					<p class="text-gray-400 text-sm">Enregistrement, arrangement et mixage studio</p>
				</div>
				<div class="text-center">
					<div class="w-16 h-16 bg-[#E7C873] bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4">
						<span class="text-[#E7C873] font-bold text-lg">4</span>
					</div>
					<h4 class="text-white font-semibold mb-2">Livraison</h4>
					<p class="text-gray-400 text-sm">Finalisation avec crédits producteur</p>
				</div>
			</div>
		</div>
	</section>

	<!-- CTA FINAL -->
	<section class="py-20 px-6 bg-black">
		<div class="max-w-4xl mx-auto text-center">
			<h2 class="title-artistic text-4xl text-white mb-6">
				Prêt à devenir producteur ?
			</h2>
			<p class="text-gray-300 text-lg mb-8">
				Comme ce client, raconte ton histoire en musique.
			</p>
			<button class="bg-[#E7C873] text-black px-12 py-4 text-lg font-medium tracking-wide hover:bg-[#d4b556] transition-all duration-300 hover:scale-105">
				DÉMARRER MA PRODUCTION - 199€
			</button>
		</div>
	</section>

	<!-- FOOTER -->
	<footer class="py-16 px-6 border-t border-gray-800">
		<div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center">
			<div>
				<div class="title-artistic text-2xl text-[#E7C873] mb-2">Poppy Music</div>
				<div class="text-artistic text-sm text-gray-400 uppercase tracking-wider">Studio de Production Musicale</div>
			</div>
			<div class="text-gray-500 text-sm mt-8 md:mt-0">
				© 2024 Poppy Music Laboratory. Tous droits réservés.
			</div>
		</div>
	</footer>

	<!-- PLAYER FUNCTIONALITY -->
	<script type="module">
		// @ts-nocheck
		// Simple player for use case page
		document.addEventListener('DOMContentLoaded', () => {
			const container = document.getElementById('useCasePlayer');
			const audio = container.querySelector('audio');
			const playButton = container.querySelector('.album-play-button');
			
			if (audio && playButton) {
				container.addEventListener('click', (e) => {
					e.stopPropagation();
					
					if (audio.paused) {
						container.classList.add('playing');
						audio.play().catch(console.error);
					} else {
						audio.pause();
						container.classList.remove('playing');
					}
				});
				
				audio.addEventListener('play', () => {
					container.classList.add('playing');
					const svg = playButton.querySelector('svg');
					if (svg) {
						svg.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>'; // Pause icon
					}
				});
				
				audio.addEventListener('pause', () => {
					container.classList.remove('playing');
					const svg = playButton.querySelector('svg');
					if (svg) {
						svg.innerHTML = '<path d="M8 5v14l11-7z"/>'; // Play icon
					}
				});
				
				audio.addEventListener('ended', () => {
					container.classList.remove('playing');
					const svg = playButton.querySelector('svg');
					if (svg) {
						svg.innerHTML = '<path d="M8 5v14l11-7z"/>'; // Play icon
					}
				});
			}
		});
	</script>
</body>
</html>
